solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-2,-7)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-20,-17)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-20,-7)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-2,-7)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-1,-7)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-1,-5)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-1,-6)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-10,-1,-30)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-9,-5,-30)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-9,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-15,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 2, 3), cbind(2,-1,5), cbind(3,5,-2))
b = rbind(-25,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 7, 3), cbind(7,-1,5), cbind(3,5,-2))
b = rbind(-25,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 7, 3), cbind(7,-7,5), cbind(3,5,-10))
b = rbind(-25,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 7, 3), cbind(7,-7,5), cbind(3,5,-1))
b = rbind(-25,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 7, 3), cbind(7,-7,5), cbind(3,5,-3))
b = rbind(-25,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 7, 3), cbind(7,-2,5), cbind(3,5,-3))
b = rbind(-25,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 7, 4), cbind(7,-2,5), cbind(4,5,-3))
b = rbind(-25,-5,-3)
solve(A,b)
A = rbind(cbind(-5, 7, 4), cbind(7,-2,5), cbind(4,5,-3))
b = rbind(-25,-15,-9)
solve(A,b)
A = rbind(cbind(-5, 7, 4), cbind(7,-2,5), cbind(4,5,-3))
b = rbind(-5,-15,-9)
solve(A,b)
A
inv(A)
A = rbind(cbind(-3, 7, 4), cbind(7,-2,5), cbind(4,5,-5))
b = rbind(-5,-15,-9)
solve(A,b)
A
A = rbind(cbind(-3, 7, 4), cbind(7,-2,1), cbind(4,1,-5))
A
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(-5,-15,-9)
A
b = rbind(-5,-15,-9)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(-25,-1,-9)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(-2,-1,-9)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(-2,-4,-9)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(-2,-4,-10)
solve(A,b)
b = rbind(-6,-4,-10)
solve(A,b)
b = rbind(-6,-5,-10)
solve(A,b)
b = rbind(-6,-5,-15)
solve(A,b)
b = rbind(-6,-9,-15)
solve(A,b)
b = rbind(-6,-1,-15)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(4,-1,-15)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(4,1,-15)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(4,2,-15)
solve(A,b)
A = rbind(cbind(-3, 5, 4), cbind(5,-2,1), cbind(4,1,-5))
b = rbind(6,2,-15)
solve(A,b)
b = rbind(10,2,-15)
solve(A,b)
b = rbind(30,2,-15)
solve(A,b)
b = rbind(30, 20,-15)
solve(A,b)
b = rbind(30, 20,10)
solve(A,b)
b = rbind(33, 20, 10)
solve(A,b)
A = rbind(cbind(-3, 5, 2), cbind(5,-2,1), cbind(2,1,-5))
b = rbind(30, 20, 10)
solve(A,b)
b = rbind(3, 2, 1)
solve(A,b)
A = rbind(cbind(-4, 5, 2), cbind(5,-2,1), cbind(2,1,-5))
b = rbind(30, 20, 10)
solve(A,b)
A = rbind(cbind(-4, 5, 2), cbind(5,-2,1), cbind(2,1,-5))
b = rbind(3, 2, 1)
solve(A,b)
b = rbind(6, 2, 1)
solve(A,b)
b = rbind(6, 3, 1)
solve(A,b)
b = rbind(6, 2, 1)
solve(A,b)
b = rbind(6, 2, 3)
solve(A,b)
b = rbind(6, 2, 1)
solve(A,b)
A
A = rbind(cbind(-4, 3, 2), cbind(3,-2,1), cbind(2,1,-5))
b = rbind(6, 2, 1)
solve(A,b)
A = rbind(cbind(-4, 5, 2), cbind(5,-2,1), cbind(2,1,-5))
b = rbind(7, 2, 1)
solve(A,b)
A = rbind(cbind(-4, 3, 2), cbind(3,-2,1), cbind(2,1,-5))
b = rbind(6, 2, 1)
solve(A,b)
A = rbind(cbind(-4, 3, 2), cbind(3,-2,1), cbind(2,1,-6))
b = rbind(6, 2, 1)
solve(A,b)
A=matrix(c(0,1,0,0,0,1,0,0,0),3,3)
A
A%*%A%*%A
(diag(3)-A)%*%(diag(3)+A+A%*%A)
9/6+1/13
library(MASS)
fractions(9/6+1/13)
fractions(3/12+1/13)
fractions(11/4+2/!3)
fractions(11/4+2/13)
fractions(9/4+1/2)
fractions(9/12+2/13)
fractions(9/4+1/13)
fractions(3/2+2/13)
fractions(3/2+18/13)
fractions(1/4+18/13)
fractions(1/2+9/13)
fractions(3/4+9/13)
fractions(1+9/13)
38/13
41/26
11/4
121/52
34/13
75/26
18/13
85/52
43/26
75/52
22/13
41/26
11/4
121/52
22/13
31/26
75/52
fractions(3/2+2/13)
fractions(1/2+9/13)
31/26
43/26
9/13+3/4
fractions(9/13+3/4)
22/13
31/26
fractions(9/13+1/2)
31/26
3/2
(29+13*15/52)/5
FRACTIONS((29+13*15/52)/5)
fractions((29+13*15/52)/5)
A=matrix(c(1,0,2,-4,3,8,2,5,-4),3,3)
b=matrix(c(3,-7,-3),3,1)
inv(A)%*%b
sove(A)%*%b
solve(A)%*%b
A
b
15/104
b
solve(A)
solve(A)%*%b
fractions(solve(A)%*%b)
library(matlib)
A=matrix(c(2,3,4,3,2,1,3,3,2),3,3)
b=matrix(c(25,24,21),3,1)
echelon(A,b)
19/5
25*3
75-48
-50+21
27*3
27*2
54-81
21/5
27-16
11/5
27-8
19/5
A
b
125-81
-81/10+25/2
22/10
16/5
A=matrix(c(2,3,1,7,9,5,3,4,3),3,3)
solve(A)
2/3
4/3
5/3
7/3
1/3
B=matrix(c(5,1,-5,3,-3,2,1,-2,1),3,3)
B
solve(B)
fractions(solve(B))
fraction(solve(B))
library(MASS)
fractions(solve(B))
C=matrix(c(-8,-5,-2,3,9,15,0,0,0),3,3)
C
solve(B)%*%C
fractions(solve(B)%*%C)
B=matrix(c(2,4,5,-3,-5,-7,1,2,3),3,3)
C=matrix(c(9,1,1,7,1,1,6,2,1),3,3)
fractions(solve(B))
fractions(solve(C))
D=matrix(c(2,18,23,0,12,15,-2,9,11),3,3)
solve(B)%*%D%*%solve(C)
A=matrix(c(-1,2,1,-7,15,3,-3,6,2))
solve(A)
A=matrix(c(-1,2,1,-7,15,3,-3,6,2),3,3)
solve(A)
A=matrix(c(1,3,0,0,1,0,1,0,-1),3,3)
A
A=matrix(c(1,3,0,0,1,1,1,0,-1),3,3)
A
solve(A)
A=matrix(c(3,0,-6,-4,1,7,-2,1,5),3,3)
det(A)
A
A=matrix(c(,-1,1,2,-3,2,-8,5,4),3,3)
A=matrix(c(2,-1,1,2,-3,2,-8,5,4),3,3)
A
det(A)
library(matlib)
A=matrix(c(1,0,-2,3,0,1,2,3,2,-2,-8,0,2,-1,10,3,3,-1,-6,9),4,5)
A
echelon(A)
A=matrix(c(1,0,-2,3,0,1,2,3,2,-1,10,3,3,-1,-6,9),4,4)
A
echelon(A)
A=matrix(c(1,0,0,1,-2,0,0,2,3,-1,2,-1,5,-3,3,-4,2,-1,1,0),4,5)
A
echelon(A)
4/5
6/7
library(MASS)
fractions(echelon(a))
fractions(echelon(A))
library(matlib)
A=matrix(c(1,-2,3,0,3,-1,2,-1,5,0,0,-1),3,4)
A
echelon(A)
library(matlib)
A=matrix(c(-2,0,-2,6,3,3,-4,0,-4,6,3,3), 3,4)
A
echelon(A)
library(matlib)
A=matrix(c(1,0,0,1,4,0,0,0,0,1,0,0,2,-1,0,0,0,0,1,0),4,5)
A
echelon(A)
A=matrix(c(1,8,10,97,0,1,0,1,0,0,2,0,0,1,1,3),4,4)
det(A)
16*12/20
A=matrix(c(2,1,3,0,0,0,0,0,0,0,0,0,2,1,3,0,0,0,0,0,0,0,0,0,2,1,3,-1,2,1,0,0,0,0,0,0,0,0,0,-1,2,1,0,0,0,0,0,0,0,0,0,-1,2,1),9,6)
library(matlib)
echelon(A)
A=matrix(c(1,0,-2,3,0,1,2,3,2,-2,-8,0,2,-1,10,3,3,-1,-6,9),4,5)
A
echelon(A)
A=matrix(c(1,0,-2,3,0,1,2,3,2,-1,10,3,3,-1,-6,9),4,4)
A
echelon(A)
A=matrix(c(-3,1,2,6,-2,-4,-1,2,5,1,3,8,-7,-1,-4),3,5)
echelon(A)
A=matrix(c(3,6,-8,-5,-2,4,-3,0,1),3,3)
w=matrix(c(1,3,-4),3,1)
A%*%w
A=matrix(c(2,-3,-5,6,2,-4,4,5,1),3,3)
w=matrix(c(1,-1,1),3,1)
A
A%*%w
A=matrix(c(10,0,1,1,-8,2,-1,1,-2,2,6,0,-2,-2,0,-2),4,4)
w=matrix(c(2,2,0,2),4,1)
A%*%w
A=matrix(c(1,0,2,1,4,3,0,-2),2,4)
echelon(A)
A=matrix(c(1,0,0,-4,0,0,0,1,0,2,-5,0,0,0,2),3,5)
echelon(A)
w=c(3,-1,-5)
x=c(6,-2,3)
w*x
?dot
dot(x,w)
w%.%x
sum(w*x)
sum(x*x)
norm(w)
sqrt(sum(w*w))
sum(w*w)
sum(x*x)
sqrt(sum(12^2+3^2+5^2))
sum(12^2+3^2+5^2)
sum(2^2+3^2+3^2)
(24-9-15)/(sqrt(178)*sqrt(22))
cos(0)
cos(90)
cos(pi)
cos(pi/2)
arccos(0)
cos^{-1}(0)
?cos
acos(0)
64+25
(16+15)/(sqrt(89)*sqrt(13))
acos((16+15)/(sqrt(89)*sqrt(13)))
49+4+16
13*!3
13*13
4*9
36+64
rm(list=ls())
rho <- 50
s <- 0.5
b <- 1
c <- 0.02
dim <- 500
xs <- runif(dim)
xb <- runif(dim)
tol <- 1e-10
ws0 <- matrix(xs, nrow=dim, ncol=1)
wb0 <- matrix(xb, nrow=dim, ncol=1)
wsf <- NULL
wbf <- NULL
p <- sort(xb, decreasing=T)-sort(xs)
id <- which.min(p[which(p>=0)])
p <- min(sort(xs)[id+1], sort(xb, decreasing=T)[id])
for(i in 1:dim){
wsi <- NULL
wbi <- NULL
for(j in 1:dim){
if(ws0[i]<=wb0[j]) ust <- xs[i]-c+(rho*b)*(p+0.5*(wb0[j]-ws0[i])) else ust <- xs[i]-c
us <- max(c(ust, xs[i]), na.rm=T)
wsi[j] <- us
if(ws0[j]<=wb0[i]) ubt <- -c+(rho*s)*(-p+0.5*(wb0[i]-ws0[j])) else ubt <- -c
ub <- max(c(ubt,0), na.rm=T)
wbi[j] <- ub
}
wsf[i] <- max(wsi)
wbf[i] <- max(wbi)
}
wsf
wbf
.Machine$double.eps
.Machine$double.eps*1e20
.Machine$double.eps*1e07
.Machine$tolerance*1e07
.Machine$tolerance*1e08
.Machine$double.eps*1e08
.Machine$double.eps*1e10
.Machine$double.eps*1e11
.Machine$double.eps*1e13
.Machine$double.eps*1e14
UpdateR()
updateR()
install.packages("installr")
A=matrix(c(1,0,1,0,2,1,1,1,1),3,3)
A
solve(A)
A=matrix(c(1,-1,2,2,0,6,1,1,4),3,3)
A
echelon(a)
library(matlib)
install.packages("matlib")
library(matlib)
A=matrix(c(0,2,1,0,-1,0,0,1,2,0,0,-2,0,2,-1,0),4,4)
A
echelon(A)
log(2)-log(8)
(log(2)-log(8))*(1.29)
(log(4))*(1.29)
7-1
1.29*6
(log(4))*(0.77)
(log(400))*(0.77)
(log(4))*(0.77)
(log(4))*(0.51)
exp(-1.29)
1-exp(-1.29)
8-2
6/2
3*1.29
3*exp(1.29)
exp(-1.29)
3*exp(-1.29)
3*exp(-0.77)
3*exp(1-0.77)
3*exp(-1.77)
3*exp(-1.51)
3*exp(-2.29)
1-3*exp(-2.29)
3*exp(-1.29)
3*exp(-1.29)-1
library(matlib)
A=matrix(c(0,-2,1,0,-1,0,0,1,2,0,0,-2,0,2,-1,0),4,4)
A
echelon(A)
3*1.29
300*1.29
?save
rm(list=ls())
library(MASS)
library(expm)
library(Matrix)
library(dummies)
library(plyr)
library(FixedPoint)
setwd("~/Documents/Ph.D/Econ 761 - Industrial Organization Theory/Problem sets/PS4/")
source("blp.R")
source("blpmerger.R")
x <- read.csv("cereal_ps3.csv", header = T, sep = ";")
d <- read.csv("demog_ps3.csv", header = T, sep = ";")
d$t <- paste(d$city, d$quarter, sep="_")
x$t <- paste(x$city, x$quarter, sep="_")
x$brand <- paste(x$firm, x$brand, sep="_")
x$brand <- as.factor(x$brand)
x$t <- as.factor(x$t)
x$id <- as.factor(x$id)
x$firm <- as.factor(x$firm)
x <- merge(x, d, by="t")
x$constant <- rep(1, nrow(x))
n <- 20
vars <- seq(1, 20, 1)
vars <- paste("z", vars, sep="")
Z <- data.matrix(cbind(x[,vars], dummy.data.frame(as.data.frame(x$brand))))
A <- t(Z)%*%Z
load("theta_nlin_v1.Rdata")
blp(theta_nlin=theta_nlin1, x=x, n=n, brand=T, iv=T, supply=F, A=A)
coefs
se
Rsq
Rsq_G
c(mean(b), quantile(b, 0.5), sd(b))
c(mean(mc), quantile(mc, 0.5), sd(mc))
nam <- names(coefficients(mean_u)[2:length(coefficients(mean_u))])
nam <- gsub("brand", "", nam)
resmd <- data.frame(nam, resmd)
colnames(resmd) <- c("brand", "resmd")
#Post-Nabisco merger
merger <- x
merger$xi <- residuals(mean_u)
merger$mc <- mc
merger[which(merger$firm==3), "firm"] <- 6
merger$firm <- as.character(merger$firm)
merger$firm <- as.factor(merger$firm)
merger <- join(merger, resmd, by="brand")
theta_lin=coefs
mer <- blpmerger(theta_nlin=theta_nlin1, theta_lin=theta_lin, x=merger, va=va, n=n, brand=T)
c(mean(mer[[1]]), quantile(mer[[1]], 0.5), sd(mer[[1]]))
c(mean(mer[[2]], na.rm=T), quantile(mer[[2]], 0.5, na.rm=T), sd(mer[[2]], na.rm=T))
source("jacob.R")
source("blpvcov.R")
theta_lin=coefs
x <- join(x, resmd, by="brand")
x$xi <- residuals(mean_u)
jacobian <- jacob(theta_nlin=theta_nlin1, theta_lin=theta_lin, x=x, va=va, n=n, Z=Z)
varcov <- blpvcov(theta_nlin=theta_nlin1, theta_lin=theta_lin, x=x, va=va, n=n,
jacob=jacobian, nmkt=94, nprod=24, deg=44, Z=Z)
sqrt(diag(varcov))
20+24+20
